import matplotlib.pyplot as plt
import numpy as np
import math
#vacves
RVS1=[0.154,0.16358955223880597,0.17317910447761195,0.1827686567164179,
0.19235820895522387,0.20194776119402985,0.21153731343283583,
0.2211268656716418,0.23071641791044778,0.24030597014925376,
0.2498955223880597,0.25948507462686565,0.26907462686567163,
0.2786641791044776,0.2882537313432836,0.29784328358208956,
0.30743283582089553,0.3170223880597015,0.3266119402985075,
0.33620149253731346,0.34579104477611944,0.3553805970149254,
0.3649701492537314,0.37455970149253737,0.38414925373134334,
0.39373880597014926,0.40332835820895524,0.41291791044776116,
0.42250746268656714,0.4320970149253731,0.4416865671641791,
0.45127611940298507,0.46086567164179104,0.470455223880597,0.480044776119403,
0.48963432835820897,0.49922388059701495,0.5088134328358209,
0.5184029850746269,0.5279925373134329,0.5375820895522389,0.5471716417910448,
0.5567611940298508,0.5663507462686568,0.5759402985074628,0.5855298507462687,
0.5951194029850747,0.6047089552238807,0.6142985074626867,0.6238880597014925,
0.6334776119402985,0.6430671641791045,0.6526567164179105,0.6622462686567165,
0.6718358208955224,0.6814253731343284,0.6910149253731344,0.7006044776119403,
0.7101940298507463,0.7197835820895523,0.7293731343283583,0.7389626865671642,
0.7485522388059702,0.7581417910447762,0.7677313432835822,0.7773208955223881,
0.7869104477611941,0.7965000000000001]
RVS2=[0.7965000000000001,
0.7869104477611941,0.7773208955223881,0.7677313432835822,0.7581417910447762,
0.7485522388059702,0.7389626865671642,0.7293731343283583,0.7197835820895523,
0.7101940298507463,0.7006044776119404,0.6910149253731344,0.6814253731343285,
0.6718358208955225,0.6622462686567165,0.6526567164179106,0.6430671641791046,
0.6334776119402986,0.6238880597014926,0.6142985074626867,0.6047089552238807,
0.5951194029850747,0.5855298507462687,0.5759402985074628,0.5663507462686568,
0.5567611940298508,0.5471716417910448,0.537582089552239,0.5279925373134329,
0.518402985074627,0.5088134328358209,0.499223880597015,0.489634328358209,
0.48004477611940305,0.4704552238805971,0.4608656716417911,0.4512761194029851,
0.44168656716417914,0.4320970149253732,0.42250746268656725,
0.41291791044776127,0.4033283582089553,0.3937388059701493,
0.38414925373134334,0.37455970149253737,0.3649701492537314,
0.3553805970149254,0.34579104477611944,0.33620149253731346,
0.32661194029850754,0.31702238805970157,0.3074328358208956,
0.2978432835820896,0.2882537313432836,0.2786641791044777,0.26907462686567174,
0.25948507462686576,0.2498955223880598,0.2403059701492538,
0.23071641791044784,0.22112686567164186,0.21153731343283588,
0.2019477611940299,0.19235820895522393,0.18276865671641795,
0.17317910447761198,0.163589552238806,0.154]
ZVS1=[0.7885,0.7695,0.7505,0.7315,0.7125,0.6935,0.6745,0.6555,
0.6365000000000001,0.6174999999999999,0.5985,0.5795,0.5605,0.5415,0.5225,
0.5035000000000001,0.4845,0.4655,0.4465,0.4275,0.40850000000000003,0.3895,
0.3705,0.35150000000000003,0.3325,0.3135,0.2945,0.27549999999999997,
0.25650000000000006,0.23750000000000004,0.21850000000000003,0.1995,0.1805,
0.16149999999999998,0.14249999999999996,0.12350000000000005,
0.10450000000000004,0.08550000000000002,0.0665,0.04749999999999999,
0.02849999999999997,0.009500000000000064,-0.009499999999999953,
-0.02849999999999997,-0.04749999999999999,-0.0665,-0.08550000000000002,
-0.10449999999999993,-0.12349999999999994,-0.14249999999999996,
-0.16149999999999998,-0.1805,-0.1994999999999999,-0.21850000000000003,
-0.23749999999999993,-0.25650000000000006,-0.27549999999999997,
-0.2944999999999999,-0.3135,-0.3324999999999999,-0.35150000000000003,
-0.37049999999999994,-0.38950000000000007,-0.4085,-0.4274999999999999,
-0.4465,-0.4654999999999999,-0.48450000000000004,-0.5035,-0.5225000000000001,
-0.5415,-0.5604999999999999,-0.5795,-0.5984999999999999,-0.6175,-0.6365,
-0.6554999999999999,-0.6745,-0.6934999999999999,-0.7125,-0.7314999999999999,
-0.7505000000000001,-0.7695,-0.7884999999999999]
ZVS2=[-0.7690476190476191,-0.7305952380952381,-0.6921428571428572,
-0.6536904761904762,-0.6152380952380953,-0.5767857142857142,
-0.5383333333333333,-0.49988095238095237,-0.4614285714285714,
-0.42297619047619045,-0.3845238095238095,-0.3460714285714286,
-0.3076190476190476,-0.26916666666666667,-0.23071428571428565,
-0.19226190476190474,-0.15380952380952384,-0.11535714285714282,
-0.07690476190476192,-0.038452380952380905,0.0,0.038452380952381016,
0.07690476190476192,0.11535714285714282,0.15380952380952384,
0.19226190476190474,0.23071428571428576,0.26916666666666667,
0.30761904761904757,0.3460714285714287,0.3845238095238096,0.4229761904761905,
0.4614285714285714,0.4998809523809523,0.5383333333333334,0.5767857142857143,
0.6152380952380953,0.6536904761904762,0.6921428571428573,0.7305952380952382,
0.7690476190476191]
R=np.zeros(len(RVS1)+84+len(RVS2)+41)
R[:len(RVS1)]=RVS1                                                              
R[len(RVS1):len(RVS1)+84]=0.804                                                 
R[len(RVS1)+84:len(RVS1)+84+len(RVS2)]=RVS2                                     
R[len(RVS1)+84+len(RVS2):]=0.152                                                
Z=np.zeros(68+len(ZVS1)+68+len(ZVS2))                                           
Z[:68]=0.8075                                                                  
Z[68:68+len(ZVS1)]=ZVS1                                                         
Z[68+len(ZVS1):68+len(ZVS1)+68]=-0.8075
Z[68+len(ZVS1)+68:]=ZVS2                                    

W=np.ones(len(Z))
W[:68]=0.009999999999999998
W[68:68+84]=0.008
W[68+84:68+84+68]=0.009999999999999998
W[68+84+68:]=0.004
H=np.ones(len(Z))
H[:68]=0.015
H[68:68+84]=0.01875
H[68+84:68+84+68]=0.015
H[68+84+68:]=0.0375
A=np.zeros(len(Z))
A2=np.zeros(len(Z))

#coil.dat
#Solenoid
RE = np.ones(290)
RE[:145]=0.1205
RE[145:]=0.1395
ZE=[-0.7795000000000001,-0.7686736111111112,-0.7578472222222223,
-0.7470208333333335,-0.7361944444444445,-0.7253680555555556,
-0.7145416666666667,-0.7037152777777779,-0.692888888888889,-0.6820625,
-0.6712361111111111,-0.6604097222222223,-0.6495833333333334,
-0.6387569444444445,-0.6279305555555557,-0.6171041666666668,
-0.6062777777777778,-0.5954513888888889,-0.5846250000000001,
-0.5737986111111112,-0.5629722222222222,-0.5521458333333333,
-0.5413194444444445,-0.5304930555555556,-0.5196666666666667,
-0.5088402777777778,-0.4980138888888889,-0.48718750000000005,
-0.4763611111111111,-0.46553472222222225,-0.4547083333333334,
-0.44388194444444445,-0.4330555555555556,-0.4222291666666667,
-0.4114027777777778,-0.4005763888888889,-0.38975000000000004,
-0.3789236111111111,-0.36809722222222224,-0.35727083333333337,
-0.34644444444444444,-0.33561805555555557,-0.3247916666666667,
-0.3139652777777778,-0.3031388888888889,-0.29231250000000003,
-0.2814861111111111,-0.27065972222222223,-0.25983333333333336,
-0.2490069444444445,-0.2381805555555555,-0.22735416666666663,
-0.21652777777777776,-0.2057013888888889,-0.19487500000000002,
-0.18404861111111115,-0.17322222222222217,-0.1623958333333333,
-0.15156944444444442,-0.14074305555555555,-0.12991666666666668,
-0.11909027777777781,-0.10826388888888883,-0.09743749999999995,
-0.08661111111111108,-0.07578472222222221,-0.06495833333333334,
-0.05413194444444436,-0.043305555555555486,-0.032479166666666615,
-0.021652777777777743,-0.010826388888888872,0.0,0.010826388888888983,
0.021652777777777854,0.032479166666666726,0.0433055555555556,
0.05413194444444447,0.06495833333333334,0.07578472222222232,
0.0866111111111112,0.09743750000000007,0.10826388888888894,
0.11909027777777781,0.12991666666666668,0.14074305555555566,
0.15156944444444453,0.1623958333333334,0.17322222222222228,
0.18404861111111115,0.19487500000000002,0.205701388888889,
0.21652777777777787,0.22735416666666675,0.23818055555555562,
0.2490069444444445,0.25983333333333336,0.27065972222222223,
0.2814861111111111,0.2923125000000002,0.30313888888888907,
0.31396527777777794,0.3247916666666668,0.3356180555555557,
0.34644444444444455,0.3572708333333334,0.3680972222222223,
0.37892361111111117,0.38975000000000004,0.4005763888888889,
0.4114027777777778,0.4222291666666669,0.43305555555555575,0.4438819444444446,
0.4547083333333335,0.46553472222222236,0.47636111111111124,
0.4871875000000001,0.498013888888889,0.5088402777777778,0.5196666666666667,
0.5304930555555556,0.5413194444444445,0.5521458333333336,0.5629722222222224,
0.5737986111111113,0.5846250000000002,0.595451388888889,0.6062777777777779,
0.6171041666666668,0.6279305555555557,0.6387569444444445,0.6495833333333334,
0.6604097222222223,0.6712361111111114,0.6820625000000002,0.6928888888888891,
0.703715277777778,0.7145416666666669,0.7253680555555557,0.7361944444444446,
0.7470208333333335,0.7578472222222223,0.7686736111111112,0.7795000000000001,
-0.7795000000000001,-0.7686736111111112,-0.7578472222222223,
-0.7470208333333335,-0.7361944444444445,-0.7253680555555556,
-0.7145416666666667,-0.7037152777777779,-0.692888888888889,-0.6820625,
-0.6712361111111111,-0.6604097222222223,-0.6495833333333334,
-0.6387569444444445,-0.6279305555555557,-0.6171041666666668,
-0.6062777777777778,-0.5954513888888889,-0.5846250000000001,
-0.5737986111111112,-0.5629722222222222,-0.5521458333333333,
-0.5413194444444445,-0.5304930555555556,-0.5196666666666667,
-0.5088402777777778,-0.4980138888888889,-0.48718750000000005,
-0.4763611111111111,-0.46553472222222225,-0.4547083333333334,
-0.44388194444444445,-0.4330555555555556,-0.4222291666666667,
-0.4114027777777778,-0.4005763888888889,-0.38975000000000004,
-0.3789236111111111,-0.36809722222222224,-0.35727083333333337,
-0.34644444444444444,-0.33561805555555557,-0.3247916666666667,
-0.3139652777777778,-0.3031388888888889,-0.29231250000000003,
-0.2814861111111111,-0.27065972222222223,-0.25983333333333336,
-0.2490069444444445,-0.2381805555555555,-0.22735416666666663,
-0.21652777777777776,-0.2057013888888889,-0.19487500000000002,
-0.18404861111111115,-0.17322222222222217,-0.1623958333333333,
-0.15156944444444442,-0.14074305555555555,-0.12991666666666668,
-0.11909027777777781,-0.10826388888888883,-0.09743749999999995,
-0.08661111111111108,-0.07578472222222221,-0.06495833333333334,
-0.05413194444444436,-0.043305555555555486,-0.032479166666666615,
-0.021652777777777743,-0.010826388888888872,0.0,0.010826388888888983,
0.021652777777777854,0.032479166666666726,0.0433055555555556,
0.05413194444444447,0.06495833333333334,0.07578472222222232,
0.0866111111111112,0.09743750000000007,0.10826388888888894,
0.11909027777777781,0.12991666666666668,0.14074305555555566,
0.15156944444444453,0.1623958333333334,0.17322222222222228,
0.18404861111111115,0.19487500000000002,0.205701388888889,
0.21652777777777787,0.22735416666666675,0.23818055555555562,
0.2490069444444445,0.25983333333333336,0.27065972222222223,
0.2814861111111111,0.2923125000000002,0.30313888888888907,
0.31396527777777794,0.3247916666666668,0.3356180555555557,
0.34644444444444455,0.3572708333333334,0.3680972222222223,
0.37892361111111117,0.38975000000000004,0.4005763888888889,
0.4114027777777778,0.4222291666666669,0.43305555555555575,0.4438819444444446,
0.4547083333333335,0.46553472222222236,0.47636111111111124,
0.4871875000000001,0.498013888888889,0.5088402777777778,0.5196666666666667,
0.5304930555555556,0.5413194444444445,0.5521458333333336,0.5629722222222224,
0.5737986111111113,0.5846250000000002,0.595451388888889,0.6062777777777779,
0.6171041666666668,0.6279305555555557,0.6387569444444445,0.6495833333333334,
0.6604097222222223,0.6712361111111114,0.6820625000000002,0.6928888888888891,
0.703715277777778,0.7145416666666669,0.7253680555555557,0.7361944444444446,
0.7470208333333335,0.7578472222222223,0.7686736111111112,0.7795000000000001]
WE = 0.011
HE = 0.011
#PF coils
RF=[0.25,0.5,0.7,0.94,0.25,0.5,0.7,0.94]
ZF=[0.7,0.7,0.575,0.2,-0.7,-0.7,-0.575,-0.2]
WF=[0.075,0.075,0.075,0.075,0.075,0.075,0.075,0.075]
HF=[0.075,0.05,0.05,0.05,0.075,0.05,0.05,0.05]
AF=[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]
AF2=[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]
FCTURN=[36.0,24.0,24.0,24.0,36.0,24.0,24.0,24.0]
NAME=['DIV1T','DIV2T','PF2T','PF1T','DIV1B','DIV2B','PF2B','PF1B']
Smax=np.max(WF)*np.max(HF)
dS=Smax/20
order=[0,4,1,5,2,6,3,7]
seq=[1,1,2,2,3,3,4,4]
nf=len(RF)
for i in range(nf):
    j=order[i]
    print(int(WF[j]*HF[j]/dS))
    print(RF[j],ZF[j],WF[j],HF[j],' 0.0 90.0',' 0.0 ',FCTURN[j],seq[i],NAME[j],i+1)
    plt.plot([RF[j]-WF[j]/2,RF[j]+WF[j]/2],[ZF[j]-HF[j]/2,ZF[j]-HF[j]/2],'b')
    plt.plot([RF[j]-WF[j]/2,RF[j]+WF[j]/2],[ZF[j]+HF[j]/2,ZF[j]+HF[j]/2],'b')
    plt.plot([RF[j]-WF[j]/2,RF[j]-WF[j]/2],[ZF[j]-HF[j]/2,ZF[j]+HF[j]/2],'b')
    plt.plot([RF[j]+WF[j]/2,RF[j]+WF[j]/2],[ZF[j]-HF[j]/2,ZF[j]+HF[j]/2],'b')
#Solenoid:
n=len(RE)
R1=np.mean(RE[:np.int(n/2)])
R2=np.mean(RE[np.int(n/2):])
Z1=np.mean(ZE[:np.int(n/2)])
Z2=np.mean(ZE[np.int(n/2):])
Z1max=np.max(ZE[:np.int(n/2)])
Z1min=np.min(ZE[:np.int(n/2)])
Z2max=np.max(ZE[np.int(n/2):])
Z2min=np.min(ZE[np.int(n/2):])
dZ1=Z1max-Z1min
dZ2=Z2max-Z2min
dR1=WE
dR2=WE
print('64')
print(R1,Z1,dR1,dZ1,' 0.0 90.0',n/2,'5      SOL  9')
print('64')
print(R2,Z2,dR2,dZ2,' 0.0 90.0',n/2,'5      SOL  10')
plt.plot(RF,ZF,'+')
plt.plot([R1,R2],[Z1,Z2],'+')
plt.plot([R1+dR1/2,R1-dR1/2],[Z1-dZ1/2,Z1-dZ1/2],'b')
plt.plot([R1+dR1/2,R1-dR1/2],[Z1+dZ1/2,Z1+dZ1/2],'b')
plt.plot([R1-dR1/2,R1-dR1/2],[Z1-dZ1/2,Z1+dZ1/2],'b')
plt.plot([R1+dR1/2,R1+dR1/2],[Z1-dZ1/2,Z1+dZ1/2],'b')
plt.plot([R2+dR2/2,R2-dR2/2],[Z2-dZ2/2,Z2-dZ2/2],'b')
plt.plot([R2+dR2/2,R2-dR2/2],[Z2+dZ2/2,Z2+dZ2/2],'b')
plt.plot([R2-dR2/2,R2-dR2/2],[Z2-dZ2/2,Z2+dZ2/2],'b')
plt.plot([R2+dR2/2,R2+dR2/2],[Z2-dZ2/2,Z2+dZ2/2],'b')
# vacves output

resistivity=8.67e-7
num=[0,68,68+84,68+84+68,68+84+68+41]
for j in range(4):
    RV1=np.min(R[num[j]:num[j+1]])
    RV2=np.max(R[num[j]:num[j+1]])
    ZV1=np.min(Z[num[j]:num[j+1]])
    ZV2=np.max(Z[num[j]:num[j+1]])
    W1=np.mean(W[num[j]:num[j+1]])
    H1=np.mean(H[num[j]:num[j+1]])
    ovres=0
    S=0
    for i in range(num[j],num[j+1]):
        ovres=ovres+H[i]*W[i]/(2*math.pi*R[i])
        S=S+H[i]*W[i]
    print(RV1,ZV1,RV2,ZV2,1/ovres*1e6*resistivity,' 0.0')
    plt.plot([RV1,RV2],[ZV1,ZV2])

XMP2=[0.154,0.154,0.154,0.273875,0.49624999999999997,0.6993750000000001,0.8,0.8,0.8,0.8,0.8,0.273875,0.49624999999999997,0.6993750000000001,0.154,0.154,0.154,0.154,0.154,0.273875,0.49624999999999997,0.6993750000000001,0.8,0.8,0.8,0.8,0.8,0.273875,0.49624999999999997,0.6993750000000001,0.154,0.154]
YMP2=[0.0,0.24,0.56,0.8,0.8,0.8,0.5517916666666667,0.23785,0.0,-0.23785,-0.5517916666666667,-0.8,-0.8,-0.8,-0.56,-0.24000000000000005,0.0,0.24,0.56,0.8,0.8,0.8,0.5517916666666667,0.23785,0.0,-0.23785,-0.5517916666666667,-0.8,-0.8,-0.8,-0.56,-0.24000000000000005]
AMP2=[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,90.0,90.0,90.0,90.0,90.0,90.0,90.0,90.0,90.0,90.0,90.0,90.0,90.0,90.0,90.0,90.0]
MPNAM2=['H000','H001','H002','H003','H004','H005','H006','H007','H008','H009','H010','H011','H012','H013','H014','H015','V000','V001','V002','V003','V004','V005','V006','V007','V008','V009','V010','V011','V012','V013','V014','V015']
plt.plot(XMP2,YMP2,'*')
for j in range(len(AMP2)): 
    print(XMP2[j],YMP2[j],AMP2[j]*math.pi/180,MPNAM2[j])
    plt.text(XMP2[j],YMP2[j],str(int(AMP2[j]))) 
plt.show()
#flux loops
RSI=[0.154,0.154,0.154,0.154,0.154,0.154,0.39375,0.59875,0.8,0.25,0.5,0.7,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.39375,0.154,0.25,0.5,0.7,0.154,0.154,0.154,0.154,0.8,0.8]
ZSI = [0.0,0.16,0.32,0.48,0.64,0.8,0.8,0.8,0.8,0.6625,0.6749999999999999,0.5499999999999999,0.7007166666666667,0.6014333333333334,0.50215,0.3457,-0.3457,-0.50215,-0.6014333333333334,-0.7007166666666667,-0.8,-0.8,-0.8,-0.6625,-0.6749999999999999,-0.5499999999999999,-0.64,-0.48000000000000004,-0.32000000000000006,-0.16000000000000003,0.13,-0.13] 
LPNAME = ['F000','F001','F002','F003','F004','F005','F006','F007','F008','F009','F010','F011','F012','F013','F014','F015','F016','F017','F018','F019','F020','F021','F022','F023','F024','F025','F026','F027','F028','F029','F030','F031']
print(-len(RSI))
plt.plot(RSI,ZSI,'*')
for j in range(len(AMP2)): 
    print(RSI[j],ZSI[j],LPNAME[j])
    plt.text(RSI[j],ZSI[j],LPNAME[j])
plt.show()
